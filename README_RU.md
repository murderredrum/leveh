# Hevel - Плавающий оконный менеджер для Wayland

## Описание

Hevel - это плавающий оконный менеджер с возможностью прокрутки для Wayland, который использует мышиные аккорды для выполнения команд. Его дизайн вдохновлен идеями из статьи Роба Пайка 1988 года "Window Systems Should be Transparent", доведенными до логического завершения. Таким образом, можно сказать, что это модернизация линии управляемых мышью оконных систем Unix/Plan9, таких как mux, 8½ и rio, все созданные Робом Пайком. Однако, отличие заключается в том, что здесь нет меню, и вы не ограничены пространством одного экрана; вы можете бесконечно прокручивать вверх и вниз, создавая окна где угодно на плоскости.

Он реализован с использованием замечательной библиотеки swc с рядом расширений.

## Особенности

- Прокручиваемый рабочий стол
- Управление мышиными аккордами
- Плавающие окна
- Поддержка нескольких экранов
- Автоматическая прокрутка при перемещении окон к краям экрана
- Возможность убийства окон через аккорды
- Терминалы с поддержкой порождения процессов

## Установка на Arch Linux

### Установка зависимостей

Для установки Hevel на Arch Linux необходимо установить следующие зависимости:

```bash
sudo pacman -S base-devel wayland wayland-protocols libinput pixman xorg-xkbcomp xkeyboard-config libdrm libudev xcb-util xcb-util-wm xcb-util-image xcb-util-cursor wld-git
```

Также рекомендуется установить хотя бы один из поддерживаемых терминалов для возможности запуска терминалов через аккорды:

```bash
sudo pacman -S foot alacritty kitty xterm rxvt-unicode gnome-terminal
```

Также потребуется установить swc - основную библиотеку, на которой работает Hevel:

```bash
git clone https://github.com/michaelforney/swc.git
cd swc
make
sudo make install
```

### Сборка и установка Hevel

```bash
# Клонирование репозитория (если еще не сделано)
git clone https://github.com/your-repo/hevel.git
cd hevel

# Сборка проекта
make

# Установка
sudo make install
```

### Альтернативная установка через AUR

Если доступен пакет в AUR, его можно установить следующим образом:

```bash
yay -S hevel
# или
paru -S hevel
```

## Управление с помощью мышиных аккордов

Команды выполняются с использованием мышиных аккордов, то есть комбинаций нажатия кнопок мыши. Левый клик обозначается как 1, клик колесика мыши как 2, правый клик как 3.

- **1 -> 3 -> перетаскивание -> отпускание** - создает новый терминал в выделенной области
- **3 -> 1 -> движение мыши над целевым окном -> отпускание** - убивает целевое окно
- **3 -> 2 -> отпустите 2, и пока держите палец на колесике, прокручивайте вверх/вниз** - прокрутка всего рабочего пространства
- **2 -> 3 -> отпустите 2 над окном, затем перетащите с 3 для изменения размера окна**
- **2 -> 1 -> отпустите 2 над окном, затем перетащите с 1 для перемещения окна. Если перетащить к нижнему/верхнему краю экрана, начнется прокрутка.**

## Конфигурация

Конфигурация производится через файл `config.h` во время компиляции. Основные параметры:

- Цвета границ окон (активных и неактивных)
- Ширина границ
- Настройки прокрутки
- Тема курсора
- Параметры порождения терминалов
- Пороги для автопрокрутки при перемещении окон

## Запуск

Hevel можно запустить напрямую или как часть сессии Wayland:

```bash
# Простой запуск
./hevel

# Или через скрипт
./starthevel.sh
```

## Оптимизации для Arch Linux

### 1. Улучшенный Makefile для Arch

Внесены изменения в Makefile для лучшей совместимости с Arch Linux:

- Обновлены пути к библиотекам
- Добавлена поддержка стандартных путей установки Arch
- Использование системных библиотек вместо встроенных

### 2. Улучшенная поддержка оборудования

- Оптимизация для современного оборудования Arch
- Лучшая поддержка графических драйверов
- Улучшенная работа с различными конфигурациями мониторов

### 3. Интеграция с systemd

Предоставлен юнит для запуска в сессии Wayland через systemd:

```ini
[Unit]
Description=Hevel Wayland Compositor
After=graphical-session.target

[Service]
Type=simple
ExecStart=/usr/local/bin/hevel
Restart=on-failure

[Install]
WantedBy=graphical-session.target
```

## Устранение неполадок

### Проблемы с запуском

Если возникают проблемы с запуском:

1. Убедитесь, что переменная `WAYLAND_DISPLAY` не установлена в другую сессию:
   ```bash
   unset WAYLAND_DISPLAY
   ```

2. Проверьте права доступа к устройствам ввода:
   ```bash
   ls -la /dev/input/
   ```

3. Убедитесь, что установлены все зависимости.

### Проблемы с отображением

Если возникают проблемы с отображением:

1. Проверьте поддержку DRM:
   ```bash
   lsmod | grep drm
   ```

2. Убедитесь, что запускаете из TTY, а не из другой сессии X11/Wayland.

## Лицензия

Это экспериментальное программное обеспечение! Используйте на свой страх и риск.

Проект распространяется под лицензией, указанной в файле LICENSE.